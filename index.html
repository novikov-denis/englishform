<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz Input Form</title>
    <style>
        .container {
            width: 50%;
            margin: auto;
        }
        .result {
            white-space: pre-wrap;
            background: #f4f4f4;
            padding: 10px;
            border: 1px solid #ccc;
        }
        .option-group {
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Квиз – одиночный выбор</h1>
        <form id="quiz-form">
            <label for="quiz-content">Текст задания квиза:</label>
            <textarea id="quiz-content" rows="4" cols="50"></textarea>
            <br>
            <div id="options-container">
                <div class="option-group">
                    <label for="option-1">Option 1:</label>
                    <input type="text" id="option-1">
                    <br>
                    <label for="feedback-1">Feedback:</label>
                    <input type="text" id="feedback-1">
                </div>
            </div>
            <button type="button" onclick="addOption()">Add Option</button>
            <br><br>
            <button type="button" onclick="generateJson()">Generate JSON</button>
        </form>
        <h2>Result:</h2>
        <div class="result" id="result"></div>
        <button onclick="copyToClipboard()">Copy to Clipboard</button>
    </div>

    <script>
        let optionCount = 1;

        function generateUUID() {
            return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {
                var r = Math.random() * 16 | 0, v = c == 'x' ? r : (r & 0x3 | 0x8);
                return v.toString(16);
            });
        }

        function addOption() {
            optionCount++;
            const optionsContainer = document.getElementById('options-container');
            const newOptionGroup = document.createElement('div');
            newOptionGroup.className = 'option-group';
            newOptionGroup.innerHTML = `
                <label for="option-${optionCount}">Option ${optionCount}:</label>
                <input type="text" id="option-${optionCount}">
                <br>
                <label for="feedback-${optionCount}">Feedback:</label>
                <input type="text" id="feedback-${optionCount}">
            `;
            optionsContainer.appendChild(newOptionGroup);
        }

        function generateJson() {
            const quizContent = document.getElementById('quiz-content').value;
            const optionsContainer = document.getElementById('options-container');
            const optionGroups = optionsContainer.getElementsByClassName('option-group');
            const options = [];

            for (let i = 0; i < optionGroups.length; i++) {
                const optionContent = optionGroups[i].querySelector(`input[id^="option-"]`).value;
                const feedbackContent = optionGroups[i].querySelector(`input[id^="feedback-"]`).value;
                options.push({
                    id: generateUUID(),
                    content: optionContent,
                    correct: false,
                    feedback: feedbackContent,
                    "feedback-positive": "",
                    "feedback-negative": ""
                });
            }

            const result = {
                content: {
                    options: options,
                    type: "radio",
                    id: generateUUID(),
                    content: quizContent,
                    blocking: true,
                    show_all_feedback: false,
                    result_text: "",
                    button_text: "Узнать ответ"
                },
                type: "QuizSelect"
            };

            document.getElementById('result').innerText = JSON.stringify(result, null, 2);
        }

        function copyToClipboard() {
            const result = document.getElementById('result');
            const range = document.createRange();
            range.selectNode(result);
            window.getSelection().removeAllRanges();
            window.getSelection().addRange(range);
            document.execCommand('copy');
            window.getSelection().removeAllRanges();
            alert('Copied to clipboard');
        }
    </script>
</body>
</html>
